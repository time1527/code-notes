2025-02-09 18:14:23,949 - train.py - 74 - INFO - train dataset size: 50000
2025-02-09 18:14:23,949 - train.py - 75 - INFO - test dataset size: 10000
2025-02-09 18:14:24,008 - train.py - 138 - INFO - ModelConfig(n_layers=6, d_model=128, d_ffn=512, n_heads=8, dropout=0.05, img_height=32, img_width=32, channels=3, n_classes=10, patch_size=4)
2025-02-09 18:14:24,008 - train.py - 139 - INFO - TrainConfig(n_epochs=100, batch_size=2048, grad_clip=1.0, save_epochs=50, lr_config={'lr': 0.001, 'warmup_iters': 100, 'min_lr': 1e-05})
2025-02-09 18:14:24,008 - train.py - 140 - INFO - Start training...
2025-02-09 18:14:38,005 - train.py - 192 - INFO - Epoch 1/100, Train Loss: 2.1063, Train Acc: 0.2137, Test Loss: 1.9991, Test Acc: 0.2598
2025-02-09 18:14:51,909 - train.py - 192 - INFO - Epoch 2/100, Train Loss: 1.9387, Train Acc: 0.2793, Test Loss: 1.8936, Test Acc: 0.3007
2025-02-09 18:15:05,777 - train.py - 192 - INFO - Epoch 3/100, Train Loss: 1.8285, Train Acc: 0.3160, Test Loss: 1.7842, Test Acc: 0.3452
2025-02-09 18:15:20,164 - train.py - 192 - INFO - Epoch 4/100, Train Loss: 1.7630, Train Acc: 0.3414, Test Loss: 1.7582, Test Acc: 0.3574
2025-02-09 18:15:34,799 - train.py - 192 - INFO - Epoch 5/100, Train Loss: 1.6658, Train Acc: 0.3852, Test Loss: 1.6812, Test Acc: 0.4025
2025-02-09 18:15:49,604 - train.py - 192 - INFO - Epoch 6/100, Train Loss: 1.5530, Train Acc: 0.4299, Test Loss: 1.4692, Test Acc: 0.4594
2025-02-09 18:16:04,199 - train.py - 192 - INFO - Epoch 7/100, Train Loss: 1.4665, Train Acc: 0.4640, Test Loss: 1.4256, Test Acc: 0.4670
2025-02-09 18:16:18,631 - train.py - 192 - INFO - Epoch 8/100, Train Loss: 1.4138, Train Acc: 0.4848, Test Loss: 1.3139, Test Acc: 0.5216
2025-02-09 18:16:39,322 - train.py - 192 - INFO - Epoch 9/100, Train Loss: 1.3532, Train Acc: 0.5110, Test Loss: 1.2901, Test Acc: 0.5387
2025-02-09 18:17:00,435 - train.py - 192 - INFO - Epoch 10/100, Train Loss: 1.2942, Train Acc: 0.5306, Test Loss: 1.2611, Test Acc: 0.5354
2025-02-09 18:17:19,577 - train.py - 192 - INFO - Epoch 11/100, Train Loss: 1.2464, Train Acc: 0.5498, Test Loss: 1.1695, Test Acc: 0.5819
2025-02-09 18:17:33,392 - train.py - 192 - INFO - Epoch 12/100, Train Loss: 1.2010, Train Acc: 0.5663, Test Loss: 1.1410, Test Acc: 0.5901
2025-02-09 18:17:47,095 - train.py - 192 - INFO - Epoch 13/100, Train Loss: 1.2191, Train Acc: 0.5620, Test Loss: 1.1444, Test Acc: 0.5927
2025-02-09 18:18:00,798 - train.py - 192 - INFO - Epoch 14/100, Train Loss: 1.1582, Train Acc: 0.5813, Test Loss: 1.0912, Test Acc: 0.6042
2025-02-09 18:18:14,506 - train.py - 192 - INFO - Epoch 15/100, Train Loss: 1.1270, Train Acc: 0.5950, Test Loss: 1.1259, Test Acc: 0.5944
2025-02-09 18:18:28,199 - train.py - 192 - INFO - Epoch 16/100, Train Loss: 1.0982, Train Acc: 0.6016, Test Loss: 1.0860, Test Acc: 0.6107
2025-02-09 18:18:42,236 - train.py - 192 - INFO - Epoch 17/100, Train Loss: 1.0776, Train Acc: 0.6100, Test Loss: 1.0172, Test Acc: 0.6338
2025-02-09 18:18:55,974 - train.py - 192 - INFO - Epoch 18/100, Train Loss: 1.0326, Train Acc: 0.6306, Test Loss: 0.9674, Test Acc: 0.6531
2025-02-09 18:19:09,965 - train.py - 192 - INFO - Epoch 19/100, Train Loss: 1.0222, Train Acc: 0.6348, Test Loss: 0.9739, Test Acc: 0.6491
2025-02-09 18:19:24,762 - train.py - 192 - INFO - Epoch 20/100, Train Loss: 0.9865, Train Acc: 0.6469, Test Loss: 0.9293, Test Acc: 0.6714
2025-02-09 18:19:39,161 - train.py - 192 - INFO - Epoch 21/100, Train Loss: 0.9595, Train Acc: 0.6584, Test Loss: 0.9092, Test Acc: 0.6756
2025-02-09 18:19:53,177 - train.py - 192 - INFO - Epoch 22/100, Train Loss: 0.9334, Train Acc: 0.6663, Test Loss: 0.9232, Test Acc: 0.6715
2025-02-09 18:20:07,199 - train.py - 192 - INFO - Epoch 23/100, Train Loss: 0.9231, Train Acc: 0.6689, Test Loss: 0.8672, Test Acc: 0.6915
2025-02-09 18:20:24,777 - train.py - 192 - INFO - Epoch 24/100, Train Loss: 0.9173, Train Acc: 0.6743, Test Loss: 0.8763, Test Acc: 0.6927
2025-02-09 18:20:38,948 - train.py - 192 - INFO - Epoch 25/100, Train Loss: 0.8842, Train Acc: 0.6850, Test Loss: 0.8807, Test Acc: 0.6861
2025-02-09 18:20:54,816 - train.py - 192 - INFO - Epoch 26/100, Train Loss: 0.8646, Train Acc: 0.6900, Test Loss: 0.8747, Test Acc: 0.6837
2025-02-09 18:21:09,316 - train.py - 192 - INFO - Epoch 27/100, Train Loss: 0.8568, Train Acc: 0.6948, Test Loss: 0.8178, Test Acc: 0.7115
2025-02-09 18:21:23,746 - train.py - 192 - INFO - Epoch 28/100, Train Loss: 0.8258, Train Acc: 0.7060, Test Loss: 0.7967, Test Acc: 0.7150
2025-02-09 18:21:37,710 - train.py - 192 - INFO - Epoch 29/100, Train Loss: 0.8111, Train Acc: 0.7113, Test Loss: 0.8194, Test Acc: 0.7100
2025-02-09 18:21:51,467 - train.py - 192 - INFO - Epoch 30/100, Train Loss: 0.7987, Train Acc: 0.7174, Test Loss: 0.7907, Test Acc: 0.7223
2025-02-09 18:22:05,209 - train.py - 192 - INFO - Epoch 31/100, Train Loss: 0.7854, Train Acc: 0.7197, Test Loss: 0.7865, Test Acc: 0.7274
2025-02-09 18:22:18,921 - train.py - 192 - INFO - Epoch 32/100, Train Loss: 0.7598, Train Acc: 0.7324, Test Loss: 0.7744, Test Acc: 0.7290
2025-02-09 18:22:32,630 - train.py - 192 - INFO - Epoch 33/100, Train Loss: 0.7524, Train Acc: 0.7321, Test Loss: 0.7908, Test Acc: 0.7206
2025-02-09 18:22:46,494 - train.py - 192 - INFO - Epoch 34/100, Train Loss: 0.7333, Train Acc: 0.7398, Test Loss: 0.7398, Test Acc: 0.7409
2025-02-09 18:23:00,230 - train.py - 192 - INFO - Epoch 35/100, Train Loss: 0.7293, Train Acc: 0.7420, Test Loss: 0.7521, Test Acc: 0.7298
2025-02-09 18:23:15,022 - train.py - 192 - INFO - Epoch 36/100, Train Loss: 0.7034, Train Acc: 0.7516, Test Loss: 0.7131, Test Acc: 0.7501
2025-02-09 18:23:28,789 - train.py - 192 - INFO - Epoch 37/100, Train Loss: 0.7002, Train Acc: 0.7537, Test Loss: 0.7217, Test Acc: 0.7438
2025-02-09 18:23:42,400 - train.py - 192 - INFO - Epoch 38/100, Train Loss: 0.6868, Train Acc: 0.7549, Test Loss: 0.7219, Test Acc: 0.7484
2025-02-09 18:23:55,961 - train.py - 192 - INFO - Epoch 39/100, Train Loss: 0.6768, Train Acc: 0.7622, Test Loss: 0.7292, Test Acc: 0.7420
2025-02-09 18:24:09,853 - train.py - 192 - INFO - Epoch 40/100, Train Loss: 0.6514, Train Acc: 0.7674, Test Loss: 0.7032, Test Acc: 0.7551
2025-02-09 18:24:23,390 - train.py - 192 - INFO - Epoch 41/100, Train Loss: 0.6473, Train Acc: 0.7713, Test Loss: 0.6921, Test Acc: 0.7554
2025-02-09 18:24:36,938 - train.py - 192 - INFO - Epoch 42/100, Train Loss: 0.6375, Train Acc: 0.7757, Test Loss: 0.6823, Test Acc: 0.7607
2025-02-09 18:24:50,498 - train.py - 192 - INFO - Epoch 43/100, Train Loss: 0.6311, Train Acc: 0.7759, Test Loss: 0.6810, Test Acc: 0.7623
2025-02-09 18:25:04,400 - train.py - 192 - INFO - Epoch 44/100, Train Loss: 0.6183, Train Acc: 0.7812, Test Loss: 0.6623, Test Acc: 0.7691
2025-02-09 18:25:17,937 - train.py - 192 - INFO - Epoch 45/100, Train Loss: 0.6116, Train Acc: 0.7831, Test Loss: 0.6885, Test Acc: 0.7587
2025-02-09 18:25:31,522 - train.py - 192 - INFO - Epoch 46/100, Train Loss: 0.5963, Train Acc: 0.7889, Test Loss: 0.6612, Test Acc: 0.7695
2025-02-09 18:25:45,802 - train.py - 192 - INFO - Epoch 47/100, Train Loss: 0.5795, Train Acc: 0.7955, Test Loss: 0.6483, Test Acc: 0.7749
2025-02-09 18:26:00,382 - train.py - 192 - INFO - Epoch 48/100, Train Loss: 0.5826, Train Acc: 0.7936, Test Loss: 0.6764, Test Acc: 0.7682
2025-02-09 18:26:14,174 - train.py - 192 - INFO - Epoch 49/100, Train Loss: 0.5767, Train Acc: 0.7947, Test Loss: 0.6627, Test Acc: 0.7704
2025-02-09 18:26:29,039 - train.py - 192 - INFO - Epoch 50/100, Train Loss: 0.5579, Train Acc: 0.8007, Test Loss: 0.6416, Test Acc: 0.7797
2025-02-09 18:26:43,330 - train.py - 192 - INFO - Epoch 51/100, Train Loss: 0.5546, Train Acc: 0.8018, Test Loss: 0.6540, Test Acc: 0.7709
2025-02-09 18:26:57,614 - train.py - 192 - INFO - Epoch 52/100, Train Loss: 0.5473, Train Acc: 0.8071, Test Loss: 0.6514, Test Acc: 0.7737
2025-02-09 18:27:12,165 - train.py - 192 - INFO - Epoch 53/100, Train Loss: 0.5281, Train Acc: 0.8126, Test Loss: 0.6503, Test Acc: 0.7766
2025-02-09 18:27:26,067 - train.py - 192 - INFO - Epoch 54/100, Train Loss: 0.5232, Train Acc: 0.8113, Test Loss: 0.6430, Test Acc: 0.7820
2025-02-09 18:27:39,816 - train.py - 192 - INFO - Epoch 55/100, Train Loss: 0.5137, Train Acc: 0.8171, Test Loss: 0.6332, Test Acc: 0.7839
2025-02-09 18:27:53,775 - train.py - 192 - INFO - Epoch 56/100, Train Loss: 0.5078, Train Acc: 0.8200, Test Loss: 0.6298, Test Acc: 0.7820
2025-02-09 18:28:07,605 - train.py - 192 - INFO - Epoch 57/100, Train Loss: 0.4989, Train Acc: 0.8214, Test Loss: 0.6232, Test Acc: 0.7860
2025-02-09 18:28:21,674 - train.py - 192 - INFO - Epoch 58/100, Train Loss: 0.4894, Train Acc: 0.8263, Test Loss: 0.6435, Test Acc: 0.7838
2025-02-09 18:28:35,510 - train.py - 192 - INFO - Epoch 59/100, Train Loss: 0.4809, Train Acc: 0.8285, Test Loss: 0.6244, Test Acc: 0.7860
2025-02-09 18:28:49,334 - train.py - 192 - INFO - Epoch 60/100, Train Loss: 0.4727, Train Acc: 0.8316, Test Loss: 0.6426, Test Acc: 0.7821
2025-02-09 18:29:03,191 - train.py - 192 - INFO - Epoch 61/100, Train Loss: 0.4670, Train Acc: 0.8332, Test Loss: 0.6236, Test Acc: 0.7827
2025-02-09 18:29:17,006 - train.py - 192 - INFO - Epoch 62/100, Train Loss: 0.4619, Train Acc: 0.8364, Test Loss: 0.6274, Test Acc: 0.7877
2025-02-09 18:29:30,888 - train.py - 192 - INFO - Epoch 63/100, Train Loss: 0.4502, Train Acc: 0.8406, Test Loss: 0.6203, Test Acc: 0.7905
2025-02-09 18:29:45,342 - train.py - 192 - INFO - Epoch 64/100, Train Loss: 0.4412, Train Acc: 0.8436, Test Loss: 0.6147, Test Acc: 0.7887
2025-02-09 18:29:59,736 - train.py - 192 - INFO - Epoch 65/100, Train Loss: 0.4367, Train Acc: 0.8439, Test Loss: 0.6126, Test Acc: 0.7953
2025-02-09 18:30:13,361 - train.py - 192 - INFO - Epoch 66/100, Train Loss: 0.4320, Train Acc: 0.8448, Test Loss: 0.6227, Test Acc: 0.7902
2025-02-09 18:30:26,990 - train.py - 192 - INFO - Epoch 67/100, Train Loss: 0.4235, Train Acc: 0.8489, Test Loss: 0.6121, Test Acc: 0.7954
2025-02-09 18:30:40,647 - train.py - 192 - INFO - Epoch 68/100, Train Loss: 0.4151, Train Acc: 0.8532, Test Loss: 0.6100, Test Acc: 0.8004
2025-02-09 18:30:54,702 - train.py - 192 - INFO - Epoch 69/100, Train Loss: 0.4033, Train Acc: 0.8557, Test Loss: 0.5981, Test Acc: 0.8015
2025-02-09 18:31:08,977 - train.py - 192 - INFO - Epoch 70/100, Train Loss: 0.4022, Train Acc: 0.8558, Test Loss: 0.6091, Test Acc: 0.7997
2025-02-09 18:31:22,897 - train.py - 192 - INFO - Epoch 71/100, Train Loss: 0.3978, Train Acc: 0.8589, Test Loss: 0.6138, Test Acc: 0.7971
2025-02-09 18:31:37,058 - train.py - 192 - INFO - Epoch 72/100, Train Loss: 0.3892, Train Acc: 0.8616, Test Loss: 0.6029, Test Acc: 0.8020
2025-02-09 18:31:50,737 - train.py - 192 - INFO - Epoch 73/100, Train Loss: 0.3875, Train Acc: 0.8617, Test Loss: 0.5955, Test Acc: 0.8034
2025-02-09 18:32:04,717 - train.py - 192 - INFO - Epoch 74/100, Train Loss: 0.3784, Train Acc: 0.8655, Test Loss: 0.6088, Test Acc: 0.8008
2025-02-09 18:32:18,375 - train.py - 192 - INFO - Epoch 75/100, Train Loss: 0.3683, Train Acc: 0.8688, Test Loss: 0.6033, Test Acc: 0.8056
2025-02-09 18:32:32,206 - train.py - 192 - INFO - Epoch 76/100, Train Loss: 0.3664, Train Acc: 0.8705, Test Loss: 0.6081, Test Acc: 0.7994
2025-02-09 18:32:46,433 - train.py - 192 - INFO - Epoch 77/100, Train Loss: 0.3561, Train Acc: 0.8722, Test Loss: 0.6061, Test Acc: 0.8027
2025-02-09 18:33:01,042 - train.py - 192 - INFO - Epoch 78/100, Train Loss: 0.3523, Train Acc: 0.8725, Test Loss: 0.6079, Test Acc: 0.8028
2025-02-09 18:33:15,554 - train.py - 192 - INFO - Epoch 79/100, Train Loss: 0.3463, Train Acc: 0.8778, Test Loss: 0.6073, Test Acc: 0.8057
2025-02-09 18:33:28,974 - train.py - 192 - INFO - Epoch 80/100, Train Loss: 0.3463, Train Acc: 0.8771, Test Loss: 0.6140, Test Acc: 0.8054
2025-02-09 18:33:42,823 - train.py - 192 - INFO - Epoch 81/100, Train Loss: 0.3386, Train Acc: 0.8784, Test Loss: 0.6095, Test Acc: 0.8027
2025-02-09 18:33:56,332 - train.py - 192 - INFO - Epoch 82/100, Train Loss: 0.3321, Train Acc: 0.8824, Test Loss: 0.6105, Test Acc: 0.8048
2025-02-09 18:34:09,888 - train.py - 192 - INFO - Epoch 83/100, Train Loss: 0.3310, Train Acc: 0.8832, Test Loss: 0.6002, Test Acc: 0.8074
2025-02-09 18:34:23,395 - train.py - 192 - INFO - Epoch 84/100, Train Loss: 0.3222, Train Acc: 0.8843, Test Loss: 0.6002, Test Acc: 0.8088
2025-02-09 18:34:37,069 - train.py - 192 - INFO - Epoch 85/100, Train Loss: 0.3222, Train Acc: 0.8857, Test Loss: 0.6108, Test Acc: 0.8072
2025-02-09 18:34:50,515 - train.py - 192 - INFO - Epoch 86/100, Train Loss: 0.3198, Train Acc: 0.8848, Test Loss: 0.6167, Test Acc: 0.8041
2025-02-09 18:35:04,385 - train.py - 192 - INFO - Epoch 87/100, Train Loss: 0.3147, Train Acc: 0.8879, Test Loss: 0.6104, Test Acc: 0.8078
2025-02-09 18:35:18,058 - train.py - 192 - INFO - Epoch 88/100, Train Loss: 0.3147, Train Acc: 0.8861, Test Loss: 0.6142, Test Acc: 0.8049
2025-02-09 18:35:31,961 - train.py - 192 - INFO - Epoch 89/100, Train Loss: 0.3072, Train Acc: 0.8898, Test Loss: 0.6159, Test Acc: 0.8085
2025-02-09 18:35:45,488 - train.py - 192 - INFO - Epoch 90/100, Train Loss: 0.3031, Train Acc: 0.8919, Test Loss: 0.6124, Test Acc: 0.8065
2025-02-09 18:35:59,058 - train.py - 192 - INFO - Epoch 91/100, Train Loss: 0.3034, Train Acc: 0.8917, Test Loss: 0.6097, Test Acc: 0.8075
2025-02-09 18:36:12,686 - train.py - 192 - INFO - Epoch 92/100, Train Loss: 0.3014, Train Acc: 0.8925, Test Loss: 0.6120, Test Acc: 0.8061
2025-02-09 18:36:26,188 - train.py - 192 - INFO - Epoch 93/100, Train Loss: 0.3029, Train Acc: 0.8915, Test Loss: 0.6142, Test Acc: 0.8056
2025-02-09 18:36:39,892 - train.py - 192 - INFO - Epoch 94/100, Train Loss: 0.2999, Train Acc: 0.8940, Test Loss: 0.6145, Test Acc: 0.8063
2025-02-09 18:36:53,412 - train.py - 192 - INFO - Epoch 95/100, Train Loss: 0.2962, Train Acc: 0.8934, Test Loss: 0.6146, Test Acc: 0.8092
2025-02-09 18:37:06,862 - train.py - 192 - INFO - Epoch 96/100, Train Loss: 0.2935, Train Acc: 0.8954, Test Loss: 0.6158, Test Acc: 0.8077
2025-02-09 18:37:20,692 - train.py - 192 - INFO - Epoch 97/100, Train Loss: 0.2971, Train Acc: 0.8935, Test Loss: 0.6140, Test Acc: 0.8082
2025-02-09 18:37:34,269 - train.py - 192 - INFO - Epoch 98/100, Train Loss: 0.2951, Train Acc: 0.8960, Test Loss: 0.6172, Test Acc: 0.8071
2025-02-09 18:37:47,729 - train.py - 192 - INFO - Epoch 99/100, Train Loss: 0.2911, Train Acc: 0.8958, Test Loss: 0.6170, Test Acc: 0.8060
2025-02-09 18:38:01,596 - train.py - 192 - INFO - Epoch 100/100, Train Loss: 0.2944, Train Acc: 0.8949, Test Loss: 0.6155, Test Acc: 0.8078
